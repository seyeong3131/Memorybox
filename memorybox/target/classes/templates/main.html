<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/layout1}">

<!-- 사용자 CSS 추가 -->

<th:block layout:fragment="css">
 <style>
        .carousel-inner > .item {
            height : 350px;
        }
        .margin{
            margin-bottom : 30px;
        }
        .banner{
            height : 300px;
            position: absolute; top:0; left:0;
            width: 100%;
            height: 100%;
        }
        .card-text{
            text-overflow : ellipsis;
            white-space : nowrap;
            overflow : hidden;
        }
        a:hover{
            text-decoration:none;
        }
        .center{
            text-align:center;
        }
        .questionBox{
            text-align: center;
            height: 100px;
            width: 100px;
            position: fixed;
            right: 5%;
            bottom 5%;
            background-color: #ccc;
            border: 1px solid black;
        }
    </style>
</th:block>

<div layout:fragment="content">

 <div id="carouselControls" class="carousel slide margin" data-ride="carousel">
  <div class="carousel-inner">
   <div class="carousel-item active item">
    <img src="https://user-images.githubusercontent.com/13268420/112147492-1ab76200-8c20-11eb-8649-3d2f282c3c02.png" class="d-block w-100 banner" alt="First slide">
   </div>
  </div>
 </div>

 <input type="hidden" name="searchQuery" th:value="${queBundleSearchDto.searchQuery}">
 <div th:if="${not #strings.isEmpty(queBundleSearchDto.searchQuery)}" class="center">
  <p class="h3 font-weight-bold" th:text="${queBundleSearchDto.searchQuery} + '검색결과'"></p>
 </div>

 <div class="row">
  <th:block th:each="queBundle, status: ${queBundles.getContent()}">
   <div class="col-md-4-margin">
    <div class="card">
     <a th:href="'/queBundle/' + ${queBundle.id}" class="text-dark">
      <img th:src="${queBundle.imgUrl}" class="card-img-top" th:alt="${queBundle.queBundleNm}" height="400">
      <div class="card-body">
       <h4 class="card-title">[[${queBundle.queBundleNm}]]</h4>
       <p class="card-text">[[${queBundle.qCategory.description}]]</p>
      </div>
     </a>
    </div>
   </div>
  </th:block>
 </div>

 <div th:with="start=${(queBundles.number/maxPage)*maxPage +1},
        end=(${(queBundles.totalPages == 0) ? 1 : (start + (maxPage-1) < queBundles.totalPages ?
        start + (maxPage - 1) : queBundles.totalPages)})">
  <ul class="pagination justify-content-center">
   <li class="page-item" th:classappend="${queBundles.number eq 0}?'disabled'">
    <a th:href="@{'/' + '?searchQuery=' + ${queBundleSearchDto.searchQuery} + '&page=' + ${queBundles.number-1}}"
       aria-label='Previous' class="page-link">
     <span aria-hidden="true">Previous</span>
    </a>
   </li>
   <li class="page-item" th:each="page: ${#numbers.sequence(start,end)}"
       th:classappend="${queBundles.number eq page-1}?'active':''">
    <a th:href="@{'/' + '?searchQuery=' + ${queBundleSearchDto.searchQuery} + '&page=' +${page -1}}"
       th:inline="text" class="page-link">[[${page}]]</a>
   </li>
   <li class="page-item" th:classappend="${queBundles.number+1 ge queBundles.totalPages}?'disabled'">
    <a th:href="@{'/' + '?searchQuery=' + ${queBundleSearchDto.searchQuery} + '&page=' + ${queBundles.number + 1}}"
       aria-label="Next" class="page-link">
     <span aria-hidden="true">Next</span>
    </a>
   </li>
  </ul>
 </div>

 <div sec:authorize="isAuthenticated()" th:object="${saveQueAlertDtoList}" class="questionBox">
  <div th:if="${not #lists.isEmpty(saveQueAlertDtoList)}"><a th:href="@{'/saveQueBook/' + ${saveQueAlertDtoList[0].saveQueBookId}">문제풀기</a></div>
  <div th:unless="${not #lists.isEmpty(saveQueAlertDtoList)}">X</div>
 </div>

</div>